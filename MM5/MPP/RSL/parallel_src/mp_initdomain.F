C THIS ROUTINE SHOULD BE CALLED AT THE ONSET OF CALCULATION OF A DOMAIN.
C IT SETS THE DECOMPOSITION ARRAYS (USED BY RSL_READ, RSL_WRITE, AND 
C THE ROUTINES IN DEFINE_COMMS) AND IT ALSO INITIALIZES THE RSL RUN ARRAYS
C THAT WILL BE USED TO ITERATE OVER THE HORIZONTAL DIMENSIONS OF THIS DOMAIN.
C THE SINGLE ARGUMENT IS THE INDEX OF THE DOMAIN (MOTHER IS 1), AS SPECIFIED
C IN THE NAMELISTS.
 
      SUBROUTINE MP_INITDOMAIN(DID)
#include <rsl.inc>
#include <rslcom.inc>
#include <parame.incl>
#include <various.incl>
      INTEGER DID
C KEEP TRACK OF A LITTLE STATE
      INTEGER DIDNOW, DIDPREV
      COMMON /MP_INITDOMAIN_COM/ DIDNOW, DIDPREV
C THIS NEXT STATEMENT IS A FLIC MACRO.
      FLIC_RUN_DECL
      DIDPREV=DIDNOW
      DIDNOW=DID
C THIS NEXT STATEMENT IS A FLIC MACRO.
      FLIC_INIT_RUNVARS(DOMAINS(DID))
      GLEN(1) = IL
      GLEN(2) = JL
      GLEN(3) = KL
      LLEN(1) = MIX
      LLEN(2) = MJX
      LLEN(3) = MKX
      GLENK(1) = IL
      GLENK(2) = JL
      GLENK(3) = KL+1
      LLENK(1) = MIX
      LLENK(2) = MJX
      LLENK(3) = MKX+1
      DECOMP(1) = RSL_NORTHSOUTH
      DECOMP(2) = RSL_EASTWEST
      DECOMP(3) = RSL_NOTDECOMPOSED
      RETURN
      END

      SUBROUTINE MP_DOMAINSTAT(DIDNOW1,DIDPREV1)
      INTEGER DIDNOW1, DIDPREV1
      INTEGER DIDNOW, DIDPREV
      COMMON /MP_INITDOMAIN_COM/ DIDNOW, DIDPREV
      DIDNOW1 = DIDNOW
      DIDPREV1 = DIDPREV
      RETURN
      END

